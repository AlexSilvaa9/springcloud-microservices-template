<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/services/user-service/src/main/java/com/microservices/user/security/JwtUtil.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/services/user-service/src/main/java/com/microservices/user/security/JwtUtil.java" />
              <option name="originalContent" value="package com.microservices.user.security;&#10;&#10;import java.security.Key;&#10;import java.util.Date;&#10;&#10;import org.springframework.beans.factory.annotation.Value;&#10;import org.springframework.stereotype.Component;&#10;&#10;import io.jsonwebtoken.Claims;&#10;import io.jsonwebtoken.Jwts;&#10;import io.jsonwebtoken.SignatureAlgorithm;&#10;import io.jsonwebtoken.security.Keys;&#10;&#10;/**&#10; * Utilidad para generar y validar JWT.&#10; */&#10;@Component&#10;public class JwtUtil {&#10;&#10;    @Value(&quot;${security.jwt.secret:changeitchangeme}&quot;)&#10;    private String jwtSecret;&#10;&#10;    @Value(&quot;${security.jwt.expiration-ms:3600000}&quot;)&#10;    private long jwtExpirationMs;&#10;&#10;    private Key key() {&#10;        return Keys.hmacShaKeyFor(jwtSecret.getBytes());&#10;    }&#10;&#10;    public String generateToken(String subject, String role) {&#10;        Date now = new Date();&#10;        return Jwts.builder()&#10;                .setSubject(subject)&#10;                .claim(&quot;role&quot;, role)&#10;                .setIssuedAt(now)&#10;                .setExpiration(new Date(now.getTime() + jwtExpirationMs))&#10;                .signWith(key(), SignatureAlgorithm.HS256)&#10;                .compact();&#10;    }&#10;&#10;    public Claims parseClaims(String token) {&#10;        return Jwts.parserBuilder().setSigningKey(key()).build().parseClaimsJws(token).getBody();&#10;    }&#10;&#10;}&#10;&#10;" />
              <option name="updatedContent" value="package com.microservices.user.security;&#10;&#10;import java.security.Key;&#10;import java.util.Date;&#10;import java.nio.charset.StandardCharsets;&#10;&#10;import org.springframework.beans.factory.annotation.Value;&#10;import org.springframework.stereotype.Component;&#10;&#10;import io.jsonwebtoken.Claims;&#10;import io.jsonwebtoken.Jwts;&#10;import io.jsonwebtoken.SignatureAlgorithm;&#10;import io.jsonwebtoken.security.Keys;&#10;&#10;/**&#10; * Utilidad para generar y validar JWT.&#10; */&#10;@Component&#10;public class JwtUtil {&#10;&#10;    @Value(&quot;${security.jwt.secret:changeitchangeme}&quot;)&#10;    private String jwtSecret;&#10;&#10;    @Value(&quot;${security.jwt.expiration-ms:3600000}&quot;)&#10;    private long jwtExpirationMs;&#10;&#10;    private Key key() {&#10;        return Keys.hmacShaKeyFor(jwtSecret.getBytes(StandardCharsets.UTF_8));&#10;    }&#10;&#10;    public String generateToken(String subject, String role) {&#10;        Date now = new Date();&#10;        return Jwts.builder()&#10;                .setSubject(subject)&#10;                .claim(&quot;role&quot;, role)&#10;                .setIssuedAt(now)&#10;                .setExpiration(new Date(now.getTime() + jwtExpirationMs))&#10;                .signWith(key(), SignatureAlgorithm.HS256)&#10;                .compact();&#10;    }&#10;&#10;    public Claims parseClaims(String token) {&#10;        return Jwts.parserBuilder().setSigningKey(key()).build().parseClaimsJws(token).getBody();&#10;    }&#10;&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>